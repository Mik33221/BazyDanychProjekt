@page
@using System.Text.Json;
@using Sklep3.Helpers;
@{
    try
    {
        String id = Request.Query["id"];
        
        if (!string.IsNullOrEmpty(id))
        {
            // Pobierz aktualną zawartość koszyka
            var cartItems = HttpContext.Session.Get<List<string>>("CartItems") ?? new List<string>();
            
            // Dodaj nowy produkt do koszyka
            if (!cartItems.Contains(id))
            {
                cartItems.Add(id);
            }
            
            // Zapisz zaktualizowany koszyk w sesji
            HttpContext.Session.Set("CartItems", cartItems);
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine("Exception: " + ex.ToString());
    }

    Response.Redirect("/Klient/Cart");
}
